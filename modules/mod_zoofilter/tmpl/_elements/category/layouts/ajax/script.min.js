(function(a){var c=function(){};c.prototype=a.extend(c.prototype,{name:"ZFchainedAjax",options:{url:"",txtChoose:"Choose",hide_empty:0,searchAnySelection:!1},initialize:function(e,d){this.options=a.extend({},this.options,d);var b=this;a(".form-element-subrow",e).each(function(){b.fetchSelect(a(this),e)});a(".form-element-subrow",e).last().find("select").trigger("change");e.closest(".zoo-filter").find("button.zfac-clear").on("click",function(b){b.preventDefault();a(".form-element-subrow",e).eq(0).find("select").val("");
a(".form-element-subrow",e).slice(1).remove()})},fetchSelect:function(e,d){var b=this;a("select",e).on("change",function(){var c=a(this);e.nextAll(".form-element-subrow").remove();a("input",d).val("");c.val()&&(b.options.searchAnySelection&&b.saveValues(d),a.getJSON(b.options.url+"&task=getCats",{root:c.val(),hide_empty:b.options.hide_empty},function(c){var f="";a.each(c,function(a,b){f+='<option value="'+a+'">'+b+"</option>"});f?(f='<option value="">'+b.options.txtChoose+"</option>"+f,c=a('<div class="form-element-subrow"><select>'+
f+"</select></div>").insertAfter(e),b.fetchSelect(c,d)):b.options.searchAnySelection||b.saveValues(d)}))})},saveValues:function(c){var d="";a("select",c).each(function(b){d+=(0!=b?",":"")+a(this).val()});a("input",c).val(d)}});a.fn[c.prototype.name]=function(){var e=arguments,d=e[0]?e[0]:null;return this.each(function(){var b=a(this);if(c.prototype[d]&&b.data(c.prototype.name)&&"initialize"!=d)b.data(c.prototype.name)[d].apply(b.data(c.prototype.name),Array.prototype.slice.call(e,1));else if(!d||
a.isPlainObject(d)){var g=new c;c.prototype.initialize&&g.initialize.apply(g,a.merge([b],e));b.data(c.prototype.name,g)}else a.error("Method "+d+" does not exist on jQuery."+c.name)})}})(jQuery);